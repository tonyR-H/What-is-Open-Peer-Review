function noSpam(e,t){locationstring="mailto:"+e+"@"+t;window.location=locationstring}function isInteger(e){var t;for(t=0;t<e.length;t++){var n=e.charAt(t);if(n<"0"||n>"9")return!1}return!0}function createDate(e){var t=e.split("/"),n=t[0],r=t[1],i=t[2],s=new Date(i,n-1,r);return isNaN(s.getMonth())?new Date:s}function dateToString(e){var t=e.getMonth()+1,n=e.getDate(),r=e.getFullYear();t<10&&(t="0"+t);n<10&&(n="0"+n);return t+"/"+n+"/20"+(new String(r)).substring(2,4)}function stripCharsInBag(e,t){var n,r="";for(n=0;n<e.length;n++){var i=e.charAt(n);t.indexOf(i)==-1&&(r+=i)}return r}function daysInFebruary(e){return e%4!=0||e%100==0&&e%400!=0?28:29}function DaysArray(e){for(var t=1;t<=e;t++){this[t]=31;if(t==4||t==6||t==9||t==11)this[t]=30;t==2&&(this[t]=29)}return this}function isDate(e,t){var n=DaysArray(12),r=e.split(dtCh);if(r.length!=3)return!1;var i=r[dtFormat[0]],s=r[dtFormat[1]],o=r[dtFormat[2]];strYr=o;s.charAt(0)=="0"&&s.length>1&&(s=s.substring(1));i.charAt(0)=="0"&&i.length>1&&(i=i.substring(1));for(var u=1;u<=3;u++)strYr.charAt(0)=="0"&&strYr.length>1&&(strYr=strYr.substring(1));month=parseInt(i);day=parseInt(s);year=parseInt(strYr);return month<1||month>12?!1:day<1||day>31||month==2&&day>daysInFebruary(year)||day>n[month]?!1:o.length!=4||year==0||year<minYear||year>maxYear?!1:isInteger(stripCharsInBag(e,dtCh))==0?!1:!0}function isEmail(e){var t=e;return t.indexOf("@")==-1||t.indexOf(".")==-1?!1:!0}function validate(e){return validateForm(e)}function getValidationFieldName(e){return e.getAttribute("data-label")!=undefined?e.getAttribute("data-label"):e.getAttribute("label")!=undefined?e.getAttribute("label"):e.getAttribute("name")}function getValidationIsRequired(e){return e.getAttribute("data-required")!=undefined?e.getAttribute("data-required").toLowerCase()=="true":e.getAttribute("required")!=undefined?e.getAttribute("required").toLowerCase()=="true":!1}function getValidationMessage(e,t){return e.getAttribute("data-message")!=undefined?e.getAttribute("data-message"):e.getAttribute("message")!=undefined?e.getAttribute("message"):getValidationFieldName(e).toUpperCase()+t}function getValidationType(e){return e.getAttribute("data-validate")!=undefined?e.getAttribute("data-validate").toUpperCase():e.getAttribute("validate")!=undefined?e.getAttribute("validate").toUpperCase():""}function hasValidationMatchField(e){return e.getAttribute("data-matchfield")!=undefined&&e.getAttribute("data-matchfield")!=""?!0:e.getAttribute("matchfield")!=undefined&&e.getAttribute("matchfield")!=""?!0:!1}function getValidationMatchField(e){return e.getAttribute("data-matchfield")!=undefined?e.getAttribute("data-matchfield"):e.getAttribute("matchfield")!=undefined?e.getAttribute("matchfield"):""}function hasValidationRegex(e){if(e.value==undefined)return!1;if(e.getAttribute("data-regex")!=undefined&&e.getAttribute("data-regex")!="")return!0;if(e.getAttribute("regex")!=undefined&&e.getAttribute("regex")!="")return!0}function getValidationRegex(e){return e.getAttribute("data-regex")!=undefined?e.getAttribute("data-regex"):e.getAttribute("regex")!=undefined?e.getAttribute("regex"):""}function validateForm(frm){var theForm=frm,errors="",setFocus=0,started=!1,startAt,firstErrorNode,validationType="",validations={properties:{}},frmInputs=theForm.getElementsByTagName("input"),rules=new Array,data={};for(var f=0;f<frmInputs.length;f++){var theField=frmInputs[f];validationType=getValidationType(theField).toUpperCase();rules=new Array;if(theField.style.display==""){getValidationIsRequired(theField)&&rules.push({required:!0,message:getValidationMessage(theField," is required.")});validationType!=""&&(validationType=="EMAIL"&&theField.value!=""?rules.push({dataType:"EMAIL",message:getValidationMessage(theField," must be a valid email address.")}):validationType=="NUMERIC"?rules.push({dataType:"NUMERIC",message:getValidationMessage(theField," must be numeric.")}):validationType=="REGEX"&&theField.value!=""&&hasValidationRegex(theField)?rules.push({regex:hasValidationRegex(theField),message:getValidationMessage(theField," is not valid.")}):validationType=="MATCH"&&hasValidationMatchField(theField)&&theField.value!=theForm[getValidationMatchField(theField)].value?rules.push({eq:theForm[getValidationMatchField(theField)].value,message:getValidationMessage(theField," must match"+getValidationMatchField(theField)+".")}):validationType=="DATE"&&theField.value!=""&&rules.push({dataType:"DATE",message:getValidationMessage(theField," must be a valid date [MM/DD/YYYY].")}));if(rules.length){validations.properties[theField.getAttribute("name")]=rules;data[theField.getAttribute("name")]=theField.value}}}var frmTextareas=theForm.getElementsByTagName("textarea");for(f=0;f<frmTextareas.length;f++){theField=frmTextareas[f];validationType=getValidationType(theField);rules=new Array;theField.style.display==""&&getValidationIsRequired(theField)?rules.push({required:!0,message:getValidationMessage(theField," is required.")}):validationType!=""&&validationType=="REGEX"&&theField.value!=""&&hasValidationRegex(theField)&&rules.push({regex:getValidationRegex(theField),message:getValidationMessage(theField," is not valid.")});if(rules.length){validations.properties[theField.getAttribute("name")]=rules;data[theField.getAttribute("name")]=theField.value}}var frmSelects=theForm.getElementsByTagName("select");for(f=0;f<frmSelects.length;f++){theField=frmSelects[f];validationType=getValidationType(theField);rules=new Array;theField.style.display==""&&getValidationIsRequired(theField)&&rules.push({required:!0,message:getValidationMessage(theField," is required.")});if(rules.length){validations.properties[theField.getAttribute("name")]=rules;data[theField.getAttribute("name")]=theField.value}}try{$.ajax({type:"post",url:context+"/tasks/validate/",data:{data:JSON.stringify(data),validations:JSON.stringify(validations)},success:function(resp){data=eval("("+resp+")");if($.isEmptyObject(data))theForm.submit();else{var msg="";for(var e in data)msg=msg+data[e]+"\n";alert(msg)}},error:function(e){alert(JSON.stringify(e))}})}catch(err){console.log(err)}return!1}function submitForm(e,t,n){if(validateForm(e)){if(typeof t!="undefined"&&(t=="delete"&&confirm("Delete "+n+"?")||t!="delete")){var r=e.getElementsByTagName("input");for(f=0;f<r.length;f++)r[f].getAttribute("name")=="action"&&r[f].setAttribute("value",t)}e.submit();formSubmitted=!0}return!1}function createCookie(e,t,n){if(n){var r=new Date;r.setTime(r.getTime()+n*24*60*60*1e3);var i="; expires="+r.toGMTString()}else var i="";document.cookie=e+"="+t+i+"; path=/"}function readCookie(e){var t=e+"=",n=document.cookie.split(";");for(var r=0;r<n.length;r++){var i=n[r];while(i.charAt(0)==" ")i=i.substring(1,i.length);if(i.indexOf(t)==0)return unescape(i.substring(t.length,i.length))}return""}function eraseCookie(e){createCookie(e,"",-1)}function addLoadEvent(e){var t=window.onload;typeof window.onload!="function"?window.onload=e:window.onload=function(){t();e()}}function muraLoginCheck(e){var t=window.event?event.keyCode:e.keyCode;typeof pressed_keys=="undefined"&&(pressed_keys="");t==27?pressed_keys=t:t==76&&(pressed_keys=pressed_keys+""+t);t!=27&&t!=76&&(pressed_keys="");if(pressed_keys!=""){var n=pressed_keys;if(n.indexOf("2776")!=-1&&location.search.indexOf("display=login")==-1){typeof loginURL=="undefined"?lu="?display=login":lu=loginURL;typeof returnURL=="undefined"?ru=location.href:ru=returnURL;pressed_keys="";lu=new String(lu);lu.indexOf("?")!=-1?location.href=lu+"&returnUrl="+escape(ru):location.href=lu+"?returnUrl="+escape(ru)}}}function setMuraLoginCheck(){document.onkeydown=muraLoginCheck}function setHTMLEditors(e,t,n){var r=document.getElementsByTagName("textarea"),s=new Array;for(i=0;i<r.length;i++)if(r[i].className.toLowerCase()=="htmleditor")if(htmlEditorType=="fckeditor"){var o=new FCKeditor(r[i].id);o.ToolbarSet="htmlEditor";o.Config.EditorAreaCSS=themepath+"/css/editor.css";o.Config.StylesXmlPath=themepath+"/css/fckstyles.xml";o.BasePath=context+"/wysiwyg/";o.Height=e;o.Width=t;o.Config.ImageBrowser=!1;o.Config.ImageUpload=!1;o.Config.ForcePasteAsPlainText=!0;o.Config.StartupFocus=!1;o.ReplaceTextarea();s.push(o)}else{var u=CKEDITOR.instances[r[i].id],a={height:e,width:t};n!=null&&(a=extendObject(a,n));u&&CKEDITOR.remove(u);jQuery("#"+r[i].id).ckeditor(getHTMLEditorConfig(a),htmlEditorOnComplete)}}function htmlEditorOnComplete(e){if(htmlEditorType=="fckeditor"){e.ResetIsDirty();var t=FCKeditorAPI.Instances}else{var n=jQuery(e).ckeditorGet();n.resetDirty();var t=CKEDITOR.instances}}function getHTMLEditorConfig(e){var t="",n={toolbar:"htmlEditor",customConfig:"config.js.cfm"};typeof e=="object"&&(n=extendObject(n,e));return n}function extendObject(e,t){for(var n in t)e[n]=t[n];return e}if(window.Prototype){delete Object.prototype.toJSON;delete Array.prototype.toJSON;delete Hash.prototype.toJSON;delete String.prototype.toJSON}this.JSON||(JSON=function(){function f(e){return e<10?"0"+e:e}function quote(e){escapeable.lastIndex=0;return escapeable.test(e)?'"'+e.replace(escapeable,function(e){var t=meta[e];return typeof t=="string"?t:"\\u"+("0000"+(+e.charCodeAt(0)).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,i,s,o=gap,u,a=t[e];a&&typeof a=="object"&&typeof a.toJSON=="function"&&(a=a.toJSON(e));typeof rep=="function"&&(a=rep.call(t,e,a));switch(typeof a){case"string":return quote(a);case"number":return isFinite(a)?String(a):"null";case"boolean":case"null":return String(a);case"object":if(!a)return"null";gap+=indent;u=[];if(typeof a.length=="number"&&!a.propertyIsEnumerable("length")){s=a.length;for(n=0;n<s;n+=1)u[n]=str(n,a)||"null";i=u.length===0?"[]":gap?"[\n"+gap+u.join(",\n"+gap)+"\n"+o+"]":"["+u.join(",")+"]";gap=o;return i}if(rep&&typeof rep=="object"){s=rep.length;for(n=0;n<s;n+=1){r=rep[n];if(typeof r=="string"){i=str(r,a,rep);i&&u.push(quote(r)+(gap?": ":":")+i)}}}else for(r in a)if(Object.hasOwnProperty.call(a,r)){i=str(r,a,rep);i&&u.push(quote(r)+(gap?": ":":")+i)}i=u.length===0?"{}":gap?"{\n"+gap+u.join(",\n"+gap)+"\n"+o+"}":"{"+u.join(",")+"}";gap=o;return i}}Date.prototype.toJSON=function(e){return this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z"};var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapeable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;return{stringify:function(e,t,n){var r;gap="";indent="";if(typeof n=="number")for(r=0;r<n;r+=1)indent+=" ";else typeof n=="string"&&(indent=n);rep=t;if(!t||typeof t=="function"||typeof t=="object"&&typeof t.length=="number")return str("",{"":e});throw new Error("JSON.stringify")},parse:function(text,reviver){function walk(e,t){var n,r,i=e[t];if(i&&typeof i=="object")for(n in i)if(Object.hasOwnProperty.call(i,n)){r=walk(i,n);r!==undefined?i[n]=r:delete i[n]}return reviver.call(e,t,i)}var j;cx.lastIndex=0;cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+(+e.charCodeAt(0)).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver=="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());var dtCh="/",dtCh="/",minYear=1900,maxYear=2100,dtFormat=[0,1,2],dtExample="12/31/2014",HTMLEditorLoadCount=0;$(document).ready(setMuraLoginCheck);